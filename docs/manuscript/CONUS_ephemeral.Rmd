---
title: "Title: Ephemeral stream water contributions to United States drainage networks"
author:
  - Craig B Brinkerhoff:
      email: cbrinkerhoff@umass.edu
      institute: UMass
      correspondence: true
  - Colin J Gleason:
      institute: UMass
  - Matthew J Kotchen:
      institute: Yale1
  - Douglas Kysar:
      institute: Yale2
  - Peter A Raymond:
      institute: Yale1
institute:
  - UMass: Department of Civil & Environmental Engineering, University of Massachusetts Amherst, MA.
  - Yale1: School of the Environment, Yale University New Haven, CT.
  - Yale2: Yale Law School, Yale University, New Haven CT.
bibliography: References.bib
csl: science_csl.csl
output:
  word_document:
      fig_caption: yes
      pandoc_args:
        - '--lua-filter=scholarly-metadata.lua'
        - '--lua-filter=author-info-blocks.lua'
      reference_docx: word-styles-reference.docx
---

```{r setup, include=FALSE, echo=FALSE, results='hide'}
suppressWarnings({ 

library(targets)
library(captioner) #used to auto generate figure and Table numbers (so I stop going insane!)
setwd('/nas/cee-water/cjgleason/craig/CONUS_ephemeral') #R thinks it's in /manuscript...

##############SET UP AUTOMATIC TABLE NUMBERING AND CAPTIONS--------------------------------
table_nums <- captioner::captioner(prefix = "Table")
table_nums(name = "data_summary",caption = "Summary of models and data used to drive our model and generate our results. In situ data for validation is described in sections 1.4 and 4.1.")

table_nums(name="Nflw_data", caption="In situ measurements of mean annual number of flowing days for ephemeral streams")

table_nums(name="classVal", caption="Classification metrics used to assess the ephemeral mapping model. N is number of sites, TP is the true positive rate, TN is the true negative rate, FP is the false positive rate, and FN is the false negative rate.")

table_nums(name="field_data", caption="Field assessments of stream ephemerality performed in New England (Summer 2022). We followed the ephemeral/intermittent/perennial protocol for the State of North Carolina Department of Water Quality [@dorneyChapterNorthCarolina2018]. Scores < 19 are deemed 'ephemeral'.")

##############SET UP AUTOMATIC SUPP FIGURE NUMBERING AND CAPTIONS--------------------------------
fig_nums_supp <- captioner::captioner(prefix = "Figure")

fig_nums_supp(name = "flowchart_classification",caption = "Flowchart of ephemeral classification algorithm. Green are data inputs to our model. Purple are model outputs. Grey box is the actual classification algorithm. Superscripts refer to references for off-the-shelf data/models. When appropriate, we point to the figures for each result. See Methods for more detail.")

fig_nums_supp(name = "valFlowchart",caption = "Flowchart of study validation and uncertainty analysis. Green are independent data used for validation. Purple indicates model outputs. Blue are validation outputs. Superscripts refer to references for off-the-shelf data/models. When appropriate, we point to the figures for each result.")

fig_nums_supp(name = "flowchart_temporal",caption = "Flowchart of ephemeral flow frequency analysis. Green are data inputs to our model. Purple are model outputs. Blue are validation outputs. Superscripts refer to references for off-the-shelf data/models. When appropriate, we point to the figures for each result. See Methods for details.")

fig_nums_supp(name = "mainVal",caption = "Main validation of the primary model components: (A) Regional classification accuracy of the ephemeral stream map against approximately 7,000 independent in situ assessments of stream ephemerality. (B) Validation of mean annual discharge model at approximately 4,000 streams across CONUS. Note that some of the non-perennial sites were manually snapped to the NHD-HR to provide additional discharge validation. For quality control, these sites correspond to those with reported drainage areas within 20% of the drainage areas reported in the NHD-HR. (C) Verification that equation S1 is theoretically anticipated by network scaling theory. Only basins completely within the United States are used for this verification- see Supplementary Materials S1 for details on the calculation. Dashed grey lines are the 1:1 lines while black lines denote the linear regression.")

fig_nums_supp(name = "val2",caption = paste0("Regional validation of the ephemeral stream map against approximately 7,000 independent field assessments of stream ephemerality: (A) regional model true skill score (TSS) and (B) number of field-observations per region. See Table S", table_nums("classVal", display="n"), " for metric definitions. The greyed-out region ('Souris-Red-Rainy basin') has no ephemeral validation data. See Supplementary Materials S1 for more details."))

fig_nums_supp(name = "val3",caption = "Regional validation of the ephemeral stream map against approximately 7,000 independent field assessments of stream ephemerality: (A) regional model classification sensitivity and (B) specificity. The greyed-out region ('Souris-Red-Rainy basin') has no ephemeral validation data. See Supplementary Materials S1 for more details.")

fig_nums_supp(name = "val4",caption = paste0("Boxplots of regional ephemeral classification performance, by accuracy metric (section 3.2). Red dots correspond to the mean values. See Table S", table_nums("classVal", display="n"), " for metric definitions."))

fig_nums_supp(name = "grdwrtrVal",caption = "Validation of mean monthly water table depths across the United States. Histogram of model log-residuals at groundwater wells and stream gauges (their distribution is mapped in the subplot). Wells are only those with at least 20 years of data and no deeper than 100m [@jasechkoWidespreadPotentialLoss2021; @fanGlobalPatternsGroundwater2013] to calculate mean monthly well depths. Stream gauges are only those with at least 20 years of data and flowing 100% of the time. This means stream gauges represent perennial rivers with a relative water table depth of approximately 0m.")

fig_nums_supp(name = "walnutGulch",caption = "Field-scale model performance in the ephemeral Walnut Gulch experimental watershed. (A) Map of the model classification, indicating that we successfully identify the entire watershed as ephemeral. (B) Validation of the mean annual discharge model at in-situ flumes within the watershed, which are also mapped in (A). For quality control, these flume data correspond to all sites whose reported drainage areas are within 20% of the drainage areas reported in the NHD-HR. Dashed grey line is the 1:1 line while the black line denotes the linear regression.")

fig_nums_supp(name = "classificationSens",caption = "Sensitivity of ephemeral classification accuracy to the snapping threshold used to join in situ ephemerality data to the NHD-HR (section 3.3). Red points reflect the mean values.")

fig_nums_supp(name = "snappingSens",caption = paste0("Using Horton stream order scaling to find a snapping threshold (section 3.3). Points and lines show how well the in situ ephemerality data (section 1.4) fits expected network scaling theory (equation S4) given a snapping threshold to the NHD-HR. Nm refers to the number of streams per order. Purple is the root mean square error (RMSE) and green is the mean absolute error (MAE) between the in situ Nm and the Nm predicted by Horton's laws. Metrics should be smallest when the data best match Horton's laws, indicating that we correctly capturing expected network patterns and are not miss-assigning field data to the wrong rivers."))

fig_nums_supp(name = "scalingFig",caption = paste0("Scaling model for CONUS ephemeral stream network using in situ ephemerality data (section 1.4). Orange points represent ephemeral streams explicitly associated with NHD-HR reaches while the green point represents ephemeral streams implicitly represented in our headwater hydrography (see section 3.4)."))

fig_nums_supp(name="nFlwSens", caption=paste0("Sensitivity test for $N_{flw}$ (section 4.2). The white boxplot is the distribution of the actual model results presented in the paper."))

fig_nums_supp(name = "mcUncertainty",caption = "Uncertainty estimates (1 standard deviation from Monte Carlo simulations for our main metric: Eq. S1). We first parameterize uncertainty for both bankfull depth and water table depth (see Supplementary Materials S1). Then, we run 1,000 simulations of our model for each of the five basins. From those distributions, we use 1 standard deviation to characterize model uncertainty. All five uncertainties are < 1%.")

fig_nums_supp(name = "merrimack_reach_example",caption = "Example of NHD-HR hydrography versus modeled water table depths for the Cedar Brook catchment in the Merrimack River basin (New Hampshire). After comparing water table depth to bankfull depth, we then route through the network to clean up impossible scenarios due to model artifacts. See Supplementary Materials for more details.")

fig_nums_supp(name="hydrographies1", caption="Drainage network hydrographies 1-16 of 205. Sub-plot titles refer to the relative and absolute values of discharge exported from drainage networks that is ephemerally sourced (equation S1). Reach width corresponds to the size of the river (specifically, the logarithmic bins of discharge relative to map scale). Note that foreign streams are mapped as 'not ephemeral' in these plots for visualization's sake.")

fig_nums_supp(name="hydrographies2", caption="Drainage network hydrographies 17-32 of 205. Sub-plot titles refer to the relative and absolute values of discharge exported from drainage networks that is ephemerally sourced (equation S1). Reach width corresponds to the size of the river (specifically, the logarithmic bins of discharge relative to map scale). Note that foreign streams are mapped as 'not ephemeral' in these plots for visualization's sake.")

fig_nums_supp(name="hydrographies3", caption="Drainage network hydrographies 33-48 of 205. Sub-plot titles refer to the relative and absolute values of discharge exported from drainage networks that is ephemerally sourced (equation S1). Reach width corresponds to the size of the river (specifically, the logarithmic bins of discharge relative to map scale). Note that foreign streams are mapped as 'not ephemeral' in these plots for visualization's sake.")

fig_nums_supp(name="hydrographies4", caption="Drainage network hydrographies 49-64 of 205. Sub-plot titles refer to the relative and absolute values of discharge exported from drainage networks that is ephemerally sourced (equation S1). Reach width corresponds to the size of the river (specifically, the logarithmic bins of discharge relative to map scale). Note that foreign streams are mapped as 'not ephemeral' in these plots for visualization's sake.")

fig_nums_supp(name="hydrographies5", caption="Drainage network hydrographies 65-80 of 205. Sub-plot titles refer to the relative and absolute values of discharge exported from drainage networks that is ephemerally sourced (equation S1). Reach width corresponds to the size of the river (specifically, the logarithmic bins of discharge relative to map scale). Note that foreign streams are mapped as 'not ephemeral' in these plots for visualization's sake.")

fig_nums_supp(name="hydrographies6", caption="Drainage network hydrographies 81-96 of 205. Sub-plot titles refer to the relative and absolute values of discharge exported from drainage networks that is ephemerally sourced (equation S1). Reach width corresponds to the size of the river (specifically, the logarithmic bins of discharge relative to map scale). Note that foreign streams are mapped as 'not ephemeral' in these plots for visualization's sake.")

fig_nums_supp(name="hydrographies7", caption="Drainage network hydrographies 97-112 of 205. Sub-plot titles refer to the relative and absolute values of discharge exported from drainage networks that is ephemerally sourced (equation S1). Reach width corresponds to the size of the river (specifically, the logarithmic bins of discharge relative to map scale). Note that foreign streams are mapped as 'not ephemeral' in these plots for visualization's sake.")

fig_nums_supp(name="hydrographies8", caption="Drainage network hydrographies 113-128 of 205. Sub-plot titles refer to the relative and absolute values of discharge exported from drainage networks that is ephemerally sourced (equation S1). Reach width corresponds to the size of the river (specifically, the logarithmic bins of discharge relative to map scale). Note that foreign streams are mapped as 'not ephemeral' in these plots for visualization's sake.")

fig_nums_supp(name="hydrographies9", caption="Drainage network hydrographies 129-144 of 205. Sub-plot titles refer to the relative and absolute values of discharge exported from drainage networks that is ephemerally sourced (equation S1). Reach width corresponds to the size of the river (specifically, the logarithmic bins of discharge relative to map scale). Note that foreign streams are mapped as 'not ephemeral' in these plots for visualization's sake.")

fig_nums_supp(name="hydrographies10", caption="Drainage network hydrographies 145-160 of 205. Sub-plot titles refer to the relative and absolute values of discharge exported from drainage networks that is ephemerally sourced (equation S1). Reach width corresponds to the size of the river (specifically, the logarithmic bins of discharge relative to map scale). Note that foreign streams are mapped as 'not ephemeral' in these plots for visualization's sake.")

fig_nums_supp(name="hydrographies11", caption="Drainage network hydrographies 161-176 of 205. Sub-plot titles refer to the relative and absolute values of discharge exported from drainage networks that is ephemerally sourced (equation S1). Reach width corresponds to the size of the river (specifically, the logarithmic bins of discharge relative to map scale). Note that foreign streams are mapped as 'not ephemeral' in these plots for visualization's sake.")

fig_nums_supp(name="hydrographies12", caption="Drainage network hydrographies 177-192 of 205. Sub-plot titles refer to the relative and absolute values of discharge exported from drainage networks that is ephemerally sourced (equation S1). Reach width corresponds to the size of the river (specifically, the logarithmic bins of discharge relative to map scale). Note that foreign streams are mapped as 'not ephemeral' in these plots for visualization's sake.")

fig_nums_supp(name="hydrographies13", caption="Drainage network hydrographies 193-205 of 205. Sub-plot titles refer to the relative and absolute values of discharge exported from drainage networks that is ephemerally sourced (equation S1). Reach width corresponds to the size of the river (specifically, the logarithmic bins of discharge relative to map scale). Note that foreign streams are mapped as 'not ephemeral' in these plots for visualization's sake.")

fig_nums_supp(name = "drainageAreaMap",caption = "Contiguous United States map of the percent of upstream drainage area that contributes to ephemeral streams (equation S2).")

fig_nums_supp(name = "figQ_physio",caption = "Ephemeral contributions to United States drainage networks, separated by stream order and physiographic region (Fenneman & Johnson, 1946). Points correspond to the average across all basins predominately in each physiographic region. Note there is a single 10th order basin in the Appalachian Highlands, which causes the outlier value.")

fig_nums_supp(name = "runoffCalib",caption = "Determining an operational streamflow definition ($i_{min}$) using the available $N_{flw}$ data (section 4.2). MAE is mean absolute error, RMSE is root mean square error, and r2 is the coefficient of determination.")

fig_nums_supp(name = "meanFlowDate",caption = "Mean flowing month for ephemeral streams in each CONUS basin. Basins classed as ‘None’ do not flow frequently enough for a mean flowing month.")

##############SET UP AUTOMATIC FIGURE NUMBERING AND CAPTIONS--------------------------------
fig_nums <- captioner::captioner(prefix = "Figure")
fig_nums(name = "figQ",caption = paste0("Ephemeral stream water contributions to CONUS drainage networks. (A) Contiguous United States map of the percent of discharge exported from drainage networks that is ephemerally sourced (Supplementary Materials, Equation S1) with inset of the empirical cumulative distribution function of the basins. (B-E) Drainage network maps and ephemeral export percents for four representative basins: (B) endorheic desert basin, (C) arid western basin, (D) temperate, mountainous basin, and (E) a temperate, flat basin. For (B-E): reach width corresponds to the size of the river (specifically, the logarithmic bins of discharge relative to map scale). For each basin we also provide the mean annual volume of exported water that is ephemerally sourced. All 205 basins are mapped in figs. S", fig_nums_supp("hydrographies1", display="n"), '-S', fig_nums_supp("hydrographies13", display="n"), ". At the bottom are graphical insets describing how we identify ephemeral streams (see Supplementary Materials)."))

fig_nums(name="figQ_SO", caption="Ephemeral stream water contributions by river size. (A) Median percent of discharge that is ephemerally sourced by stream order, where Tukey-style boxplots are composed of 205 CONUS basins and show distributions using boxes (the 25th to 75th percentiles or the 'interquartile range' IQR), whisker lines (1.5 times the IQR), and outlier points (higher/lower than 1.5 times the IQR). Points/lines in (A) and (B) are the stream order means across CONUS basins. (B) Same, but for the median percent of upstream drainage area that is ephemeral. (C) Percent of total network length that is ephemeral. Note that only one network has 11 stream orders: the lower Columbia River. Stream orders are relative to the resolution of hydrography and cannot be directly compared across river networks. See Supplementary Materials for the source data behind these stream orders.")

fig_nums(name="figNflw", caption="How often ephemeral streams flow. (A) Contiguous United States map of the basin-average number of days that ephemeral streams flow per year with inset of the empirical cumulative distribution function of the basins. Grey points indicate approximate locations of field verification data. (B) Field verification of model results, where the black line is the linear regression between predicted and measured values. SE refers to the regression standard error and r2 refers to the coefficient of determination. (C) Field verification via empirical cumulative density functions for the in situ and modeled values from (B).")

fig_nums(name="figLengthEph", caption="Extent of the ephemeral network. Contiguous United States map of the % of the drainage network extent that is ephemeral, per our model. Inset plots the empirical cumulative distribution function of the basins.")

##############LOAD IN RESULTS--------------------------------
#model results
tar_load(combined_results)
combined_results <- dplyr::filter(combined_results, !is.na(num_flowing_dys)) #remove great lakes
tar_load(combined_results_by_order)

#validation results
tar_load(val_shapefile_fin)
val_shapefile_fin <- val_shapefile_fin$shapefile
tar_load(flowingDaysValidation)
tar_load(combined_percEph_firstOrder)
tar_load(validationPlotMain) #Q validation df (to get n obs)
tar_load(validationResults) #ephemeral classification validation (to get n obs)
tar_load(validated_wells) #groundwater vlaidation wells and gauges
tar_load(combined_meanLengthKM) #reach lengths, mean by basin in km
tar_load(validated_wells) #groundwater model residual distribution
tar_load(validated_Hb) #validated bankfull depth model

#SOME REGIONAL CATEGORIES FOR FURTHER STATS--------------------------------
combined_results$huc4 <- substr(combined_results$method, 9,13)
combined_results_by_order$huc4 <- substr(combined_results_by_order$method, 18,22)
east <- c('0101', '0102', '0103', '0104', '0105', '0106', '0107', '0108', '0109', '0110',
          '0202', '0203', '0206', '0207', '0208', '0204', '0205',
          '0301', '0302', '0303', '0304', '0305', '0306', '0307', '0308', '0309', '0310', '0311', '0312', '0313', '0314', '0315', '0316', '0317', '0318',
          '0401', '0402', '0403', '0404', '0405', '0406', '0407', '0408', '0409', '0410', '0411', '0412', '0413', '0414', '0420', '0427', '0429', '0430',
          '0501', '0502', '0503', '0504', '0505', '0506', '0507', '0508', '0509', '0510', '0511', '0512', '0513', '0514',
          '0601', '0602', '0603', '0604',
          '0701', '0703', '0704', '0705', '0707', '0709', '0712', '0713', '0714',
          '0801', '0803', '0806', '0807', '0809',
          '0901', '0902', '0903', '0904')
west <- combined_results[!(combined_results$huc4 %in% c(east)),]$huc4

southwest <- c('13', '14', '15')

badAccuracy <- c('08', '05', '06')
goodAccuracy <- c('01', '02', '18', '17', '15', '14', '13')

############SUMMARISE RESULTS-----------------------------
#stats for Q
relativeExport <- summary(combined_results$percQEph_exported)
relativeLength <- summary(combined_results$perc_length_eph)
relativeExport_da <-  summary(combined_results$percAreaEph_exported)
relativeExport_order1 <- summary(combined_results_by_order[combined_results_by_order$StreamOrde==1,]$percQEph_reach_median)

relativeExportEast_order1 <- summary(combined_results_by_order[combined_results_by_order$StreamOrde==1 & combined_results_by_order$huc4 %in% east,]$percQEph_reach_median)
relativeExportWest_order1 <- summary(combined_results_by_order[combined_results_by_order$StreamOrde==1 & combined_results_by_order$huc4 %in% west,]$percQEph_reach_median)


maxSOsByBasin <- dplyr::group_by(combined_results_by_order, method) %>%
    dplyr::slice(which.max(StreamOrde)) %>%
    dplyr::select('StreamOrde', 'Q_exported_cms')
mainstemSOs_mean <- round(mean(maxSOsByBasin$StreamOrde, na.rm=T),0)
mainstemQs_mean <- round(mean(maxSOsByBasin$Q_exported_cms, na.rm=T),0)
mainstemSOs_median <- round(median(maxSOsByBasin$StreamOrde, na.rm=T),0)
mainstemQs_median <- round(median(maxSOsByBasin$Q_exported_cms, na.rm=T),0)

overFifty <- sum(combined_results$percQEph_exported > 0.50)

mississippi <- tar_read(results_0809)
columbia <- tar_read(results_1708)

#calculate flow frequency numbers
meanFlowFreq <- round(mean(combined_results$num_flowing_dys),0)
relativeFlowFreq <- round((mean(combined_results$num_flowing_dys)/365)*100,0) #%
flowingDaysValidation$n_flw_d <- round(flowingDaysValidation$n_flw_d, 0)
flowingDaysValidation$num_flowing_dys <- round(flowingDaysValidation$num_flowing_dys, 0)
Nflw_se <- round(summary(lm(num_flowing_dys~n_flw_d, data=flowingDaysValidation))$sigma,0) #model standard error, i.e. uncertainty

#validation numbers and results
nreaches <- sum(combined_results$n_total)
nbasins <- nrow(combined_results)
nDischargeValidation <- nrow(validationPlotMain)
nMapValidation <- nrow(validationResults$validation_fin)
nGrndWrter <-  nrow(validated_wells$df)/12
perc_riverSource_eph <- round((sum(combined_percEph_firstOrder$lenKM_eph_source, na.rm=T) / sum(combined_percEph_firstOrder$lenKM_source, na.rm=T))*100,0) #%ephemeral for source reaches with no upstream reaches
perc_firstOrder_eph <- round((sum(combined_percEph_firstOrder$lenKM_eph_firstOrder, na.rm=T) / sum(combined_percEph_firstOrder$lenKM_firstOrder, na.rm=T))*100,0) #%ephemeral for source reaches with no upstream reaches

})
```

## One-Sentence Summary
Ephemeral streams influence downstream water quality and reveal implications of differing interpretations of the ‘Waters of the United States’

## Abstract
Ephemeral streams flow only in direct response to precipitation and are ubiquitous landscape features. However, little is known about their influence on downstream rivers. Here, we model ephemeral stream water contributions to the contiguous United States network of over 20,000,000 rivers, lakes, and reservoirs, finding that ephemeral streams contribute, on average, `r round(relativeExport[4]*100,0)`% of the discharge exported from regional river systems, as defined by the USGS. Our results show that ephemeral connectivity is a substantial pathway through which water and associated pollution may enter the perennial drainage network and influence water quality. We provide quantitative insight into the implications of differing interpretations of regulatory jurisdiction under the United States Clean Water Act, including the current standard adopted by the United States Supreme Court in 2023.

## Main Text
Streams transport nutrients, sediments, pollutants, and other solutes from the land surface to rivers, lakes, reservoirs, and ultimately the oceans [@raymondHydrologicalBiogeochemicalControls2016; @heAssessmentGlobalNitrogen2011; @meijerMore1000Rivers2021; @liuRiversLargestSource2021; @battinRiverEcosystemMetabolism2023], influencing all downstream water quality [@alexanderFeaturedCollectionIntroduction2018; @harveyHowHydrologicConnectivity2019]. The most upland streams (hereafter headwaters) are often 'ephemeral' streams, which flow only in direct response to precipitation and are disconnected from groundwater year-round, unlike intermittent rivers that are seasonally connected to groundwater (ephemeral streams ‘fill up’ while intermittent streams ‘run dry’). When combined, non-perennial streams (ephemeral and intermittent) account for over half of the global river network [@messagerGlobalPrevalenceNonperennial2021]. While much recent work has developed classification models to map non-perennial stream extent [@messagerGlobalPrevalenceNonperennial2021; @jaegerProbabilityStreamflowPermanence2019; @durighettoProbabilisticDescriptionStreamflow2022; @russellSpatiallyExplicitModel2015; @fesenmyerLargePortionUSA2021; @cavalloExploitingSentinel2Dataset2022; @greenhillMachineLearningPredicts2024], nearly no work focuses specifically on ephemeral streams [@fesenmyerLargePortionUSA2021; @bensteadExpandedRoleRiver2012; @stanleyEcosystemExpansionContraction1997] and all work stops short of assessing the hydrological contributions of non-perennial streams to the overall drainage network at broad spatial scales. It is well established that headwater streams contribute meaningfully to downstream water quantity and quality regionally [@alexanderRoleHeadwaterStreams2007; @fritzPhysicalChemicalConnectivity2018], but we presently have no explicit assessment of ephemeral contributions to global hydrology, nor their potential influence on downstream water quality.

In this context, we develop a model to quantify ephemeral stream contributions to river systems, defined as the percent river water that enters the river system via an upstream ephemeral catchment under mean annual conditions. The model is underpinned by a simple theory: because ephemeral streams flow only in direct response to rainfall, they must be perched above the water table over the entire year. To distinguish ephemeral streams from intermittent rivers, we first compare modeled long-term monthly water table depths [@fanGlobalPatternsGroundwater2013; @fanHydrologicRegulationPlant2017] with predicted bankfull depths [@biegerDevelopmentEvaluationBankfull2015] in `r formatC(nreaches, format="d", big.mark=",")` discrete streams, rivers, lakes, reservoirs, canals, and ditches across the contiguous United States (CONUS) [@u.s.geologicalsurveyNationalHydrographyDataset2022]. Any stream channel where the water table remains deeper than the bankfull depth across all twelve months is considered ephemeral (Fig. S`r fig_nums_supp("flowchart_classification", display="n")`). Then, we route through the river systems using a published river-lake-reservoir routing framework [@brinkerhoffLakeMorphometryRiver2021] to ensure the newly mapped ephemeral channels are not immediately downstream of perennial rivers, per theory. We validate the resulting ephemeral stream map using `r formatC(nMapValidation, format="d", big.mark=",")` in situ site assessments (see Supplementary Materials). Finally, with map in hand, we use a published streamflow model [@u.s.geologicalsurveyNationalHydrographyDataset2022] described in the Supplementary Materials and our routing framework [@brinkerhoffLakeMorphometryRiver2021] to quantify the fraction of every CONUS river's mean annual discharge that was contributed by upstream ephemeral catchments. That is, we follow water as it moves downstream (a Lagrangian framing) and keep track of its downstream dilution by larger and larger perennial rivers. We define our river systems using the United States Geological Survey (USGS) level four drainage basins in their hydrologic unit code (HUC) scheme, keeping track of when a river system flows into a downstream system. These river systems are hereafter referred to as “drainage networks”.  See Figs. S`r fig_nums_supp("flowchart_classification", display="n")`-S`r fig_nums_supp("flowchart_temporal", display="n")` for overview flowcharts of the model and its validation. See Supplementary Materials S1 and Figs. S`r fig_nums_supp("mainVal", display="n")`-S`r fig_nums_supp("merrimack_reach_example", display="n")` for the results of the validation, sensitivity, and uncertainty tests performed at over 10,000 in situ sites. By leveraging a parsimonious modeling approach, our goal is not simply to show that ephemeral streams occur, but to elucidate how their prevalence shapes the hydrology of rivers many kilometers downstream.

Our scientific findings speak directly to the ongoing debate surrounding the jurisdictional scope of the United States Clean Water Act (CWA) and whether it applies to ephemeral streams. The CWA grants federal agencies the authority to regulate the 'Waters of the United States' (WOTUS) in order “to restore and maintain the chemical, physical, and biological integrity of the Nation’s waters” [@CleanWaterAct1972]. While there is general agreement that WOTUS includes large interstate waterways characterized as 'navigable waters', differing and conflicting interpretations apply to wetlands and smaller/tributary interconnected waterways, especially those that are ephemeral [@walshOverviewEvolvingJurisdictional2022; @keiserConsequencesCleanWater2019]. For many years, no majority United States Supreme Court opinion controlled the scope of WOTUS, leaving regulators to navigate among competing definitions such as waters that are 'inseparably bound up' with navigable waters [@UnitedStatesRiverside1985], waters that hold a 'significant nexus' with navigable waters [@RapanosUS2006], and- most narrowly- waters that are 'relatively permanent, standing or continuously flowing bodies of water' [@RapanosUS2006]. In the past decade alone, federal agencies under three administrations all promulgated rules with differing definitions of the CWA's jurisdictional scope, including one that explicitly excluded ephemeral streams from federal coverage [@departmentofthearmycorpsofengineersdepartmentofdefenseCleanWaterRule2015; @departmentofthearmycorpsofengineersdepartmentofdefenseNavigableWatersProtection2020; @departmentofthearmycorpsofengineersdepartmentofdefenseRevisedDefinitionWaters2023]. The issue was addressed once again by the United States Supreme Court in the 2023 case of Sackett v. Environmental Protection Agency (EPA), where a majority of the Court narrowly defined WOTUS as encompassing “only those relatively permanent, standing or continuously flowing bodies of water forming geographical features that are described in ordinary parlance as streams, oceans, rivers, and lakes” [@SackettEPA2023] and effectively removing ephemeral streams from U.S. federal jurisdiction. Recently, deep learning was used to predict what fraction of CONUS waters are regulated under these different interpretations of the Clean Water Act by mapping and quantifying the spatial footprint of regulation [@greenhillMachineLearningPredicts2024], similar to previous work [@messagerGlobalPrevalenceNonperennial2021; @jaegerProbabilityStreamflowPermanence2019; @durighettoProbabilisticDescriptionStreamflow2022; @russellSpatiallyExplicitModel2015; @fesenmyerLargePortionUSA2021; @cavalloExploitingSentinel2Dataset2022]. We too provide mapping of ephemeral streams, but specifically focus on the magnitude of water that ephemeral streams contribute to river systems. We provide novel results for both the scientific and regulatory communities that enriches mapping efforts and may help in establishing the importance of ephemeral streams to water quality science and regulation.

## The ephemeral pulse of drainage networks
On average across CONUS basins, we predict `r round(relativeExport[4]*100,0)`% of annual discharge exported from HUC level four (HUC4) drainage networks is sourced from upstream ephemeral streams (Fig. `r fig_nums("figQ", display="n")`a). This means that, on average, the majority of streamflow in the large, mainstem rivers of these networks (defined by HUC4 basins) is contributed by upstream ephemeral catchments. Mainstem rivers are often ‘navigable waters’ and thus fall under CWA regulation. For example, `r round(mississippi$percQEph_export*100,0)`% of the Mississippi River export originated in ephemeral catchments, and Columbia river export is similar at `r round(columbia$percQEph_export*100,0)`% ephemeral. This result varies significantly across basins (from `r round(relativeExport[1]*100,0)`% to `r round(relativeExport[6]*100,0)`%), with generally greater ephemeral influence in basins west of the Mississippi River. Hereafter, we refer to this region as 'West', with basins east of the Mississippi River referred to as 'East'. Regional hotspots occur where ephemeral streams most dominate the landscape, namely the desert and endorheic basins of the southwest and Great Basin (Figs. `r fig_nums("figQ", display="n")`, S`r fig_nums_supp("hydrographies1", display="n")`-S`r fig_nums_supp("hydrographies13", display="n")`). However, ephemeral contributions to discharge are consistently high across CONUS: `r round((overFifty/nrow(combined_results))*100,0)`% of networks export water that is at least 50% ephemeral. We also express the ephemeral contribution to discharge as a function of drainage area (Supplementary Materials, Equation S2), where on average across basins `r round(relativeExport_da[4]*100,0)`% of a basin's upstream drainage area is ephemeral and there is a clear east/west divide in land surface contributions to drainage networks (Fig. S`r fig_nums_supp("drainageAreaMap", display="n")`). Given that water generally accumulates in drainage networks that follow predictable scaling patterns [@tarbotonFractalNatureRiver1988; @zanardoAreAmericanRivers2013; @doddsScalingUniversalityGeomorphology2000; @tokunagaConsiderationsCompositionDrainage1978; @alexanderRoleHeadwaterStreams2007], our results (Fig. `r fig_nums("figQ", display="n")`a) are theoretically anticipated by the average upstream ephemeral network extent (Fig. S`r fig_nums_supp("mainVal", display="n")`c, Supplementary Materials S1). Our results also agree with previous modeling in northeastern CONUS, where 70% of exported discharge is sourced from headwater streams, regardless of their ephemerality [@alexanderRoleHeadwaterStreams2007].

![**Fig. `r fig_nums("figQ", display="n")`: `r substr(fig_nums("figQ", display="full"), 12, 81)`**`r substr(fig_nums("figQ", display="full"), 82, nchar(fig_nums("figQ", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/paper_figures/fig1_fin.tif)

We note that the above results are dependent on the scale of our drainage networks. Our goal is to explore the influence of ephemeral streams on major navigable rivers many kilometers away from the headwaters but still at a regionally meaningful scale. If we ran our analysis on the over 100,000 smallest HUC basins (HUC12), ephemeral contributions would be very high if not almost entirely ephemeral, whereas the 18 basins at largest size (HUC2) would aggregate too many rivers to show meaningful patterns. So, we chose to run our analysis using HUC4 basins, which colloquially correspond to “subregional” drainage basins and generally contain one or two significant mainstem rivers. This is a compromise between larger basins (which would include too many mainstem rivers and be difficult to isolate the ephemeral contributions to individual networks), and smaller basins (which would be limited exclusively to small streams and tell us little about the influence on downstream navigable waters). For reference, the HUC4 basins  used in this analysis have a median of `r mainstemSOs_median` stream orders and a median mainstem discharge of `r mainstemQs_median` $\frac{m^3}{s}$. These include, for example, the Upper Mississippi, Connecticut, Sacramento, and Suwannee rivers, and it is on these major navigable waters that we find a mean `r round(relativeExport[4]*100,0)`% contribution from ephemeral streams.

Ephemeral stream hydrography (Figs. `r fig_nums("figQ", display="n")`b-e and S`r fig_nums_supp("hydrographies1", display="n")`-S`r fig_nums_supp("hydrographies13", display="n")`) is largely governed by lateral groundwater fluxes and watershed geomorphology and is a result of both topography and climate [@gleesonClassifyingWaterTable2011; @condonEvaluatingRelationshipTopography2015]. In the East, ephemeral streams are most numerous in upland settings, where they sit upslope of the groundwater point of emergence (e.g. Figs. `r fig_nums("figQ", display="n")`d-e). In much of the West, where the water table is kilometers below the surface, ephemeral streams can dominate the landscape (Figs. `r fig_nums("figQ", display="n")`b-c). The Great Lakes/Upper Midwest region and Florida have the smallest ephemeral influence due to low-order networks with persistently shallow water tables [@fanHydrologicRegulationPlant2017]. The Midwest region is also strongly influenced by artificial irrigation ditches, which are not natural ephemeral streams but contribute significantly to annual discharge. Their contributions dilute the ephemeral influence on discharge exported from the drainage networks.

Internal to drainage networks, we show stream size exerts a fundamental control on the ephemeral contribution to downstream hydrology (Fig. `r fig_nums("figQ_SO", display="n")`). Median first-order discharge is, on average across basins, `r round(relativeExport_order1[4]*100,0)`% ephemerally sourced (Fig. `r fig_nums("figQ_SO", display="n")`a points and lines). This result varies predictably for basins east and west of the Mississippi River (`r round(relativeExportEast_order1[4]*100,0)`% versus `r round(relativeExportWest_order1[4]*100,0)`%, respectively) and by physiographic region (Fig. `r fig_nums_supp("figQ_physio", display="n")`). Given the first-order control of topography on eastern ephemeral stream presence (Fig. `r fig_nums("figQ", display="n")`), the eastern ephemeral contribution decreases rapidly to approximately 50% in large rivers, while in western basins it decreases more slowly with stream size (Fig. `r fig_nums("figQ_SO", display="n")`a). The ephemeral drainage area percent decreases similarly with stream size (Fig. `r fig_nums("figQ_SO", display="n")`b). The average ephemeral influence is notably skewed from the median ephemeral influence, highlighting the influence of outlier basins (and in particular, basins with many international streams that lower the basin’s CONUS ephemeral contribution). Overall, these results are driven by the sheer extent of ephemeral streams in orders 1-3 in the East and 1-5 in the West (Fig. `r fig_nums("figQ_SO", display="n")`c). Despite flowing infrequently (Fig. `r fig_nums("figNflw", display="n")`), the extent of the cumulative ephemeral river network means that they contribute a significant portion of annual streamflow. Our results and river network scaling theory imply that non-perennial rivers, which make up over half of the global river network [@messagerGlobalPrevalenceNonperennial2021], are likely predominately ephemeral streams rather than intermittently dry rivers.

![**Fig. `r fig_nums("figQ_SO", display="n")`: `r substr(fig_nums("figQ_SO", display="full"), 12, 66)`**`r substr(fig_nums("figQ_SO", display="full"), 67, nchar(fig_nums("figQ_SO", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/paper_figures/fig2.png)

We limit our ephemeral stream analysis to CONUS ephemeral streams because Mexican/Canadian rivers (as well as any canals, ditches, and ponds) fall under different water quality regulation rules. We also do not account for human groundwater pumping (see Supplementary Materials), which lowers water tables and likely results in under-estimates of ephemeral stream presence where pumping is significant (Fig. S`r fig_nums_supp("grdwrtrVal", display="n")`). Ephemeral streams will only become more prevalent as groundwater pumping intensifies and water tables lower further [@goodrichSouthwesternIntermittentEphemeral2018; @scanlonGroundwaterDepletionSustainability2012; @jasechkoWidespreadPotentialLoss2021]. Using Horton’s scaling laws, we also find that our hydrography is likely missing an entire stream order and thus our analysis represents a conservative estimate of ephemeral hydrography and the ephemeral pulse of CONUS drainage networks (see Supplementary Materials for details).

![**Fig. `r fig_nums("figNflw", display="n")`: `r substr(fig_nums("figNflw", display="full"), 12, 49)`**`r substr(fig_nums("figNflw", display="full"), 50, nchar(fig_nums("figNflw", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/paper_figures/fig3.png)

The significance of the ephemeral contribution to drainage networks (Figs. `r fig_nums("figQ", display="n")`-`r fig_nums("figQ_SO", display="n")`) is underpinned by how often they flow (Fig. `r fig_nums("figNflw", display="n")`). Because ephemeral streams have no groundwater component, their flow frequency is controlled by surface runoff and interflow. This means that we can use long-term runoff patterns and an operational threshold for flow to make first-order assessments of how frequently ephemeral streams flow (see Supplementary Materials and Fig. S`r fig_nums_supp("runoffCalib", display="n")`). Here, we use 27 years of daily interpolated precipitation data [@xieGaugeBasedAnalysisDaily2007] and long-term basin-averaged runoff data [@brakebillDigitalHydrologicNetworks2011] to predict that ephemeral streams flow, on average across basins, `r meanFlowFreq` $\pm$ `r Nflw_se` days per year, but with most basins only flowing approximately 0-10 days in an average year (Fig. `r fig_nums("figNflw", display="n")`a inset). When they do flow, it is usually during late Spring or early Summer (Fig. S`r fig_nums_supp("meanFlowDate", display="n")`). Ephemeral flow frequency manifests as a balance of evapotranspiration, the size and frequency of precipitation events, and antecedent moisture conditions influencing runoff generation. For example, across western basins, ephemeral streams only flow `r  round(mean(combined_results[combined_results$huc4 %in% west, ]$num_flowing_dys),0)` days a year on average, while across eastern basins they flow `r  round(mean(combined_results[combined_results$huc4 %in% east, ]$num_flowing_dys),0)` days on average. In the arid southwestern United States, this drops to an average of `r round(mean(combined_results[substr(combined_results$huc4,1,2) %in% southwest, ]$num_flowing_dys),0)` days a year.

We note that our simple model uses only interpolated precipitation data, runoff data, and an operational definition for streamflow. It reasonably matches in situ sensor data of catchment-averaged ephemeral flow frequency in the driest and wettest basins but has reduced accuracy in basins with more moderate ephemeral flow frequencies (Fig. `r fig_nums("figNflw", display="n")`b-c). With that said, we stress that extremely little data exists on ephemeral flow frequency at the drainage network scale (see Supplementary Materials) and that our initial modeling is purposefully simplistic. Future work should explore ephemeral runoff generation across distributed sensor networks to refine our modeling.

## Implications for downstream water quality
Given such infrequent flow, our results suggest that ephemeral streams likely dominate drainage network responses to storm events, shunting pollutants and other solutes downstream at even greater rates than suggested here under mean annual conditions [@raymondHydrologicalBiogeochemicalControls2016; @catalanPulseShuntStorage2022]. The exact impacts of ephemeral discharge on constituent and pollutant loads is context dependent. However, the mobilization or delivery of most elements, nutrients, and pollutants scales with discharge [@godseyCatchmentChemostasisRevisited2019; @godseyConcentrationDischargeRelationships2009] and is dominated by inputs from headwater streams [@alexanderRoleHeadwaterStreams2007; @fritzPhysicalChemicalConnectivity2018], of which `r perc_firstOrder_eph`% of CONUS first order stream extent is ephemeral according to our model. Thus, we would expect the importance and impacts of ephemerally sourced water on stream and river chemistry to be high in downstream regions that have accumulated large ephemeral water contributions (regardless of the specific loadings). However, this is a relatively simple interpretation of a complex process: the sourcing, transformation, and fate of pollutants, sediment, and other elements in space and time. It is important to stress that more research is needed across different biomes on how variability in the degree and timing of connectivity of ephemeral streams at the watershed scale is needed to fully determine the impacts to water resources [@leighEcologicalResearchManagement2016].

![**Fig. `r fig_nums("figLengthEph", display="n")`: `r substr(fig_nums("figLengthEph", display="full"), 12, 44)`**`r substr(fig_nums("figLengthEph", display="full"), 45, nchar(fig_nums("figLengthEph", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/paper_figures/fig4.png)

Our findings show that ephemeral streams are likely a substantial pathway through which pollution may influence downstream water quality, a finding that can inform evaluation of the consequences of limiting United States federal jurisdiction over ephemeral streams under the CWA. In this context, we assess the geographic extent of the CWA with and without inclusion of ephemeral streams. We find that, on average across basins, ephemeral streams account for `r round(relativeLength[4]*100,0)`% of all drainage network extent (Fig. `r fig_nums("figLengthEph", display="n")`), noting that this is underestimated due to previously discussed lack of groundwater pumping, a missing stream order, and a lower-bound on model resolution (Fig. S`r fig_nums_supp("scalingFig", display="n")`- see Supplementary Materials). Even as an underestimate, this still represents an upward revision of the only previous CONUS mapping effort that found 43-56% of the CONUS river network extent is ephemeral but with acknowledged errors of omission [@fesenmyerLargePortionUSA2021].

Taking Figs. `r fig_nums("figQ", display="n")`-`r fig_nums("figLengthEph", display="n")` in aggregate, along with regional assessments of headwater contributions to downstream water quality [@alexanderRoleHeadwaterStreams2007; @fritzPhysicalChemicalConnectivity2018] and recent global assessments of non-perennial stream extent [@fesenmyerLargePortionUSA2021; @messagerGlobalPrevalenceNonperennial2021; @greenhillMachineLearningPredicts2024], a consistent picture emerges. Non-perennial rivers (and in particular ephemeral streams) disproportionately influence river water composition along the entire drainage network, from small headwaters that are almost entirely non-perennial all the way to the major navigable mainstems of the HUC4 river systems in this study. This ephemeral influence directly implicates downstream water quality standards: excluding ephemeral streams from coverage under the CWA would significantly narrow the extent of federal authority to regulate water quality in the United States.

## References
references need to be moved here manually

## Acknowledgements

### General
We thank Y. Fan Reinfelder, the USGS, the EPA, and many field workers for making their data and/or models freely available. We also thank B. Saccardi for helping manually verify portions of the basin routing scheme. All modeling was performed on the Unity cluster at the Massachusetts Green High Performance Computing Center (MGHPCC). 

### Funding

-   National Aeronautics and Space Administration fellowship 80NSSC21K1591 (CBB, CJG)

-   National Science Foundation grant 1840243 (CBB, CJG, PAR)

### Author Contributions

-   Conceptualization: PAR, CBB, MJK, DK

-   Methodology: CBB, PAR, CJG

-   Investigation: CBB, PAR, CJG, MJK, DK

-   Visualization: CBB

-   Supervision: CJG, PAR

-   Writing- original draft: CBB

-   Writing- review & editing: CBB, CJG, PAR, MJK, DK

### Competing interests
Authors declare that they have no competing interests.

### Data and materials availability
**All data sources are available in the manuscript or the supplementary materials. Code used to run our analysis and build our figures is available at https://github.com/craigbrinkerhoff/CONUS_ephemeral and archived at [@brinkerhoffCONUS_ephemeral2023]. Model results are archived at [@brinkerhoffEphemeralStreamWater].** Note that continental-scale models prioritize capturing broad patterns across large domains, so we caution against over-interpreting results for individual river reaches.

## Supplementary Materials

Materials and Methods  
Supplementary Materials S1  
Figs. S1 to S32  
Tables S1 to S4  
References (*50-86*)

<center>

![](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/docs/manuscript/science_logo.jpg)

# Supplementary Materials for

Ephemeral stream water contributions to United States drainage networks

C.B. Brinkerhoff, C.J. Gleason, M.J. Kotchen, D. Kysar, P.A. Raymond

Correspondence to cbrinkerhoff@umass.edu

</center>

## This PDF file includes:

-   Materials and Methods

-   Supplementary Materials S1

-   Figs. S1 to S24

-   Tables S1 to S4

## Materials and Methods

All modeling and analysis was performed on the Unity Cluster at the Massachusetts Green High Performance Computing Center (MGHPCC) using publicly available datasets, models, and entirely free and open-source geoprocessing tools in the R programming language. All data and models used in this analysis are described in Table S`r table_nums('data_summary', display='n')`.

### 1 Drainage network framework

#### 1.1 Overview

We use the United States Geological Survey (USGS) National Hydrography Dataset High-Resolution (NHD-HR) built at 1:24,000 map scale [@u.s.geologicalsurveyNationalHydrographyDataset2022] for our drainage network hydrography. We use the data publicly available as of Spring 2022. This is the highest resolution hydrography data available and is often treated as a gold-standard to benchmark hydrography models against. The NHD-HR is discretized into 'reaches', which correspond to mass-conserved segments of rivers, streams, ditches, canals, lakes, and reservoirs. Note that the NHD-HR often includes estuarine bays within its hydrography. To remain consistent across the United States, we did not separate these waters from the other freshwater rivers. We treated these reaches as part of the CONUS river system, even if they have an estuarine influence. In relevant basins, this will generally provide a more conservative estimate of the ephemeral influence relative to removing these reaches, as it allows for additional dilution by perennial reaches (section 3.1). The NHD-HR uses artificial flowpaths to maintain network topology through lakes and reservoirs, and here we use a previously developed routing framework to handle complex lakes/reservoirs with multiple river inflows during our routing [@brinkerhoffLakeMorphometryRiver2021]. The NHD-HR also includes nested drainage basins across 12 levels, where higher level sub-basins are hierarchically nested within lower level basins. As described in the Main Text, we run our model at each fourth level basin (HUC4), summarizing results at this scale (Fig. `r fig_nums("figQ", display="n")`a). Our mapping validation is done at the 2nd level due to limited in situ data availability in some fourth level basins.

As with all human-built products, NHD-HR data quality varies across CONUS. We identified significantly higher drainage densities in the NHD-HR for the state of Indiana (often 1-2x the stream orders as other portions of a given basin in adjacent states). For these basins, we manually removed the lowest one or two stream orders within the Indiana portions of the basin, until the whole-basin drainage density was visually consistent across state lines. We also remove all divergent reaches, i.e. minor flowpaths that diverge from the main downstream path of flow. We do not remove the rest of the flowpath downstream of a divergent reach if there was another, non-divergent source that joined and made the path no longer divergent. Divergent channels are generally alternative flowpaths in multi-channel rivers, and so we remove them to avoid double-counting rivers.

#### 1.2 Discharge model

Each reach is associated with a mean annual discharge $\bar{Q}$ as modeled by an existing USGS surface hydrology model [@u.s.geologicalsurveyNationalHydrographyDataset2022]. They modeled mean annual runoff by closing a water balance using auxiliary datasets for mean annual precipitation, evapotranspiration (ET), and soil moisture storage. ET losses were not allowed to surpass precipitation. They then overlaid the resulting runoff atop the CONUS catchments and finally routed it downstream to produce mean annual discharge. The routing scheme also accounts for ET losses from the river surface [@u.s.geologicalsurveyNationalHydrographyDataset2022]. While developed for mean annual flow for 1970-2000, we re-validate the model for 1970-2018 to confirm its usefulness over the entire re-analysis period (Fig. S`r fig_nums_supp("mainVal", display="n")`b). We validate the discharge model for 1970-2018 using all USGS streamgauges with at least 20 years of data within that time period. For additional validation in ephemeral streams, this dataset is supplemented with mean annual flow estimates from USGS streamgauges in ephemeral/intermittent streams, as defined by various workers in USGS reports [@delongEstimatingAverageDissolvedsolids1988; @ranklRelationsTotalsedimentLoad2004; @heijljr.PreliminaryAppraisalEphemeralstreamflow1980; @schumerCharacteristicsEphemeralHydrographs2014; @elliottHydraulicGeometryStreamflow1986]. For these sites, we do not require at least 20 years of data. To quality control the sites flagged as ephemeral for later use (section 4), we use satellite imagery and hydrograph analysis to manually verify that they are not more representative of an intermittent river, i.e. visual and graphical signs of persistent baseflow, persistently waterlogged soils, riparian zones with rooty vegetation. For all other streamgauges with at least 20 years of data, we identify ephemeral/intermittent streams as those that (on average) run dry at least 5 days a year, acknowledging that sometimes zero-flow readings at streamgauges reflect other scenarios than a dry channel [@zimmerZeroNotCauses2020; @seyboldHowLowCan2023]. Validation results are discussed in Supplementary Materials S1 and plotted in Fig. S`r fig_nums_supp("mainVal", display="n")`b. In total, we validate the discharge model at `r formatC(nDischargeValidation, format="d", big.mark=",")` rivers.

It is worth noting that ephemeral streams establish losing conditions when flowing, i.e. the direction of the hydraulic head facilitates ‘transmission losses’ of water from river channel to soils and eventually groundwater [@winterGroundWaterSurface1998; @niswongerMethodEstimatingSpatially2008; @mcmahonBaseflowTransmissionLoss2021]. Transmission losses from ephemeral streams are generally of two types: groundwater recharge or evapotranspiration from the water surface and riparian corridor. In arid basins, the latter generally dominate transmission losses [@mcmahonBaseflowTransmissionLoss2021]. The discharge model and flow accumulation procedure that we use [@u.s.geologicalsurveyNationalHydrographyDataset2022] accounts for evapotranspirative transmission losses on an annual timescale, using a model of excess evapotranspiration from the river corridor for arid basins. For non-arid basins, infiltration of ephemeral flow often recharges catchment groundwater and resurfaces several stream orders downstream [@fanAreCatchmentsLeaky2019]. The discharge model does not explicitly account for this phenomenon in its flow accumulation procedure. Despite this, the model’s estimation biases were approximately similar across perennial and non-perennial rivers (Fig. S`r fig_nums_supp("mainVal", display="n")`b). This is presumably due to other model uncertainties outweighing the uncertainties associated with transmission losses. Because these biases are similarly distributed, and we use relative metrics such as the percent of total flow when reporting results, uncertainties associated with ephemeral transmission losses likely do not meaningfully influence our conclusions at this scale.

#### 1.3 Hydraulic Geometry

We use hydraulic scaling to obtain estimates of bankfull river depth and mean annual lake/reservoir depth (necessary to assess ephemerality- Section 3.1). For rivers, we use the relation from @biegerDevelopmentEvaluationBankfull2015, who fit equations of the form $H_b=aA_c^b$, where $H_b$ is field-measured bankfull depth and $A_c$ is the river’s drainage area, to eight physiographic regions across the United States (Fig. S`r fig_nums_supp("figQ_physio", display="n")`). They had over 1,300 sites in total with field-verified bankfull depths to fit their regional models. For lakes and reservoirs, we use mass-conservation to obtain average depths from lake/reservoir volume (*Vol*) and surface area *SA*. *Vol* was scaled using an equation of the form $Vol=a(SA)^{1.2}$ [@caelVolumeMeanDepth2017], developed using a global dataset of lake morphometry and the Hurst coefficient for self-affine surfaces.

#### 1.4 In situ data on stream ephemerality

We use a dataset of in situ assessments of 'stream ephemerality' to validate our stream classification model. This dataset comes from three sources: 1) EPA WOTUS jurisdictional determinations, 2) USGS streamgauges, and 3) field assessments of New England streams. Each dataset is described below.

The EPA 'Waters of the United States' (WOTUS) jurisdictional determinations dataset [@environmentalprotectionagencyCWAApprovedJDs] consists of field assessments performed by EPA workers made at landowners' requests, where status was determined under the at-the-time definition for WOTUS extent. We use the data available as of 06/20/2022 when downloaded. We filter this dataset to include only determinations made under the Navigable Waters Protection Rule [NWPR- @departmentofthearmycorpsofengineersdepartmentofdefenseNavigableWatersProtection2020] after it was enacted in 2020, which includes an explicit category for ephemeral streams. This amounts to over 60,000 distinct jurisdictional determinations (often including multiple determinations in the same reach, over space and time) and forms the bulk of our dataset. To make the dataset copacetic with our model, we remove data not associated with surface water features directly connected to the drainage network: adjacent/riparian wetlands, drylands, upland terrestrial sites, upland or non-adjacent wetlands/ponds/depressions, croplands, wastewater plants, and groundwater. We retained all other determinations that are directly connected to the drainage network (rivers, lakes, reservoirs, canals, ditches, stormwater control features, and artificial surface water features) and recast all determinations as ephemeral or non-ephemeral.

We supplement the jurisdictional determinations dataset with the USGS streamgauge network. Because the EPA jurisdictional determinations are done on a voluntary basis at landowners' requests, it is biased towards waterbodies whose WOTUS status is not so easily discerned. Thus, the EPA jurisdictional determinations rarely include larger (usually perennial) rivers. To make sure we are also correctly classifying larger rivers, we include gauged rivers (section 1.2) in our validation. All gauged rivers that, on average, are flowing 95% of the year are conservatively assumed to be non-ephemeral, and are added to the dataset as such.

Finally, we manually assess stream ephemerality in northeastern CONUS because our validation data includes no ephemeral reaches in this region. We follow the 'expert protocol' used by North Carolina's department of Water Quality for assessing stream ephemerality [@dorneyChapterNorthCarolina2018]. This protocol uses geomorphic, hydrologic, and biotic indicators of seasonally and/or permanently high water tables to assess stream permanence. We use our local knowledge to identify streams we thought are likely to be ephemeral, verify they are present in the NHD-HR (but did not look at the model result a priori to avoid biasing our assessments) and assess the channels following the protocol. Classification results are in Table S`r table_nums("field_data",display="n")` for the five sites. All streams are assessed over 48 hours from the most recent rain event to avoid the influence of delayed runoff in the channel that might be mistaken for baseflow. Note that we do not perform full soil assessments nor species counts as the protocol technically specifies, but instead perform rapid visual assessments that favor speed of classification over thoroughness. Per the protocol, none of these channels are close enough to being classified as intermittent (Table S`r table_nums("field_data",display="n")`) that we feel confident our rapid assessments are sufficient. While we only assess five ephemeral rivers, they provide at least some validation data in northeastern CONUS.

We join the three datasets to the NHD-HR by snapping each field assessment to the nearest reach. Despite its high resolution, the NHD-HR does not contain every stream in CONUS and many of the field sites are not expected to be associated with a reach. We settle on a threshold of 10m. The tests and rationale used to drive this decision are explained in section 3.3. After snapping, we assign the most frequently occurring field assessment along the reach as its 'true assessment of ephemerality'. If there is a tie between frequency of occurrence (meaning there is no consensus on whether the reach is ephemeral or non-ephemeral), we remove those points from the dataset. Ultimately, we have `r formatC(nrow(validationResults$validation_fin), format='d', big.mark=',')` field assessments of reach ephemerality to validate our model. Fig. S`r fig_nums_supp("val2", display="n")`b maps the regional distribution of these data.

### 2 Calculating ephemeral contributions
We calculate the ephemeral percent of discharge (equation S1) and drainage area (equation S2) for all `r formatC(nreaches, format="d", big.mark=",")` reaches by routing through the drainage network from upstream to downstream. When a basin discharges into a downstream drainage network, we pass the exporting reach's value to the downstream basin's corresponding reach. Routing between basins was facilitated by a custom routine which runs the drainage network routing in parallel across basins at the same 'processing level' and then passes exported parameters of interest to the basins immediately downstream in the next processing level. To calculate the basin-exported values for equations S1 and S2, we sum up the ephemeral percentages at all terminal reaches in the basin (sometimes rivers terminate endorheically and occasionally basins have two or more outlets) and then re-calculate equations S1 and S2. We also calculate the mean annual ephemeral flow frequency (equation S3, section 4).

More specifically, the ephemeral contribution to discharge $E_Q$ (equation S1) is the average of each discharge source's ephemeral contribution, weighted by discharge to favor larger water sources. *k* refers to each reach directly upstream and $Q_l$ is the lateral runoff contribution from the current reach's catchment. $E_{Q_l}$ is set to 1 for ephemeral streams and 0 for non-ephemeral streams. For losing streams (when discharge decreases downstream due to evapotranspirative losses or groundwater seepage), $E_Q_l$ is set to 0 as there is no lateral contribution into the stream channel. Equation S1 is mapped in Fig. `r fig_nums("figQ", display="n")`a.

$$E_Q = \frac{\sum_{k=1}^K{(E_{Q_k}{Q_k}})+E_{Q_l}Q_l}{\sum_{k=1}^K{(Q_k)}+Q_l}  \mathbf{(S1)}$$

The ephemeral percent of drainage area $E_A$ (equation S2) is the average of each discharge source's ephemeral drainage area, weighted by drainage area to favor larger water sources. *A* is the upstream drainage area. Equation S2 is mapped in Fig. S`r fig_nums_supp("drainageAreaMap", display="n")`.
$$E_A = \frac{\sum_{k=1}^K{(E_{A_k}{A_k}})+E_{A_l}A_l}{\sum_{k=1}^K{(A_k)}+A_l} \mathbf{(S2)}$$

Finally, we calculate basin-average ephemeral flow frequency $N_{flw}$ (equation S3) as the percent of an average year (in days) that ephemeral streams are flowing, where *i* is mean daily runoff depth and $i_{min}$ is an operational runoff threshold for day *d* in the 27-year record *Y*. This calculation is elaborated on in section 4. Equation S3 is mapped in Fig. `r fig_nums("figNflw", display="n")`a.

$$N_{flw} = \sum_{y=1}^{Y=27}(\sum_{d=1}^{D=365}(i \geq i_{min}))/27 \mathbf{(S3)}$$

### 3 Identifying ephemeral streams
#### 3.1 Model
We use a ~1km global soil hydrology model for mean monthly estimates of the water table depth (*WTD*)[@fanHydrologicRegulationPlant2017; @fanGlobalPatternsGroundwater2013]. This model solves a vertical soil water balance as inferred from remotely sensed leaf area index [@fanHydrologicRegulationPlant2017]. It ignores local, perched aquifers and anthropogenic pumping in favor of a broad, long-term average *WTD*, as is common in global-scale groundwater models [@condonGlobalGroundwaterModeling2021; @degraafHighresolutionGlobalscaleGroundwater2015]. Ignoring pumping likely leads to an underestimation of ephemeral streams, as the modeled water table is artificially high relative to the observed water table that has been lowered by pumping. Under these cases, we likely mis-classify ephemeral streams as perennial and thus underestimate the total ephemeral influence in an intensively pumped region. To quantify the influence of using a coarse, global-scale groundwater model, we validate it against in situ mean monthly water table depths (62,000+ observations over 12 months at `r formatC(nGrndWrter, format="d", big.mark=",")` sites). We use only USGS groundwater wells and USGS stream gauges with at least twenty years of data. We use stream gauges that flow 100% of the time to validate places where the water table should be approximately 0m deep (while an approximation, this provides a much more representative validation dataset). The results of this validation are described in Supplementary Materials S1 and Fig. S`r fig_nums_supp("grdwrtrVal", display="n")`.

Definitions for ephemeral and non-perennial streams vary considerably across scientific communities, regulatory communities, and jurisdictions. For example, the U.S. EPA allows states to adopt different definitions for ephemeral and intermittent streams [@buschWhatNamePatterns2020] and these definitions are frequently changing [@wadeFluidDefinitionWaters2022]. For the purposes of this study, we use the US EPA’s standard working definition for ephemeral streams: ephemeral channels only flow in direct response to precipitation [e.g. @departmentofthearmycorpsofengineersdepartmentofdefenseNavigableWatersProtection2020]. More intuitively, ephemeral streams ‘fill up’ while intermittent streams ‘run dry’. We confirm this definition is also used across all of our validation data for consistency.

Because ephemeral streams flow only in direct response to rainfall, it follows that there is no sustained stream-groundwater connection to facilitate baseflow in ephemeral channels. Thus, we assume that ephemeral stream channels must be perched above the water table over the entire year (Fig. S`r fig_nums_supp("flowchart_classification", display="n")`). This theory underpins our entire ephemeral classification model. To apply this theory, we extract the median *WTD* along all `r formatC(sum(combined_results$n_total), format="d", big.mark=",")` discrete reaches for all 12 months. We then compare each monthly water table depth to the bankfull depth: the ‘depth to channel bottom’. If the water table is deeper than the ‘depth to channel bottom’ for all 12 months, the river is classified as ephemeral (see Fig. S`r fig_nums_supp("flowchart_classification", display="n")` for an overview flowchart of the model). To avoid mis-classifying streams with an intermittently high/low water table, this must hold true for all twelve months of the year. We treat all 'main ponded waters', i.e. lakes/reservoirs $\geq 0.01 km^2$ [@schmadelSmallPondsHeadwater2019], as non-ephemeral to ensure that perennial waterbodies are not mis-classified.

Then, we route through the network from upstream to downstream and amend our initial classification to a more conservative estimate. Specifically, if a drainage path has a perennial/intermittent river or main ponded water immediately upstream of it, the current reach must also be non-ephemeral. It is well established that losing streams can lead to disconnected flowpaths at given points in time when their subsurface is able to accommodate all of the flow [@godseyDynamicDiscontinuousStream2014]. When integrated over annual timescales, any amount of intermittent surface-groundwater connectivity will contribute groundwater-sourced flow to the immediately downstream channel, rendering it non-ephemeral (at least for how we have defined ephemeral streams over annual timescales). Endorheic outlets are already accounted for in our model. We also handle two other scenarios:

- We only count rivers/streams as ephemeral and recast all canals, ditches, and small ponds (waterbodies $< 0.01 km^2$) as non-ephemeral. These features fall under different WOTUS rules and are not the focus of this study.

- While Mexican and Canadian ephemeral streams contribute discharge to the CONUS drainage network, our focus is on CONUS rivers. These streams are thus recast as non-ephemeral. If these foreign streams are larger than first order, however, we assume they are non-ephemeral and thus the model sets the CONUS stream they flow into as non-ephemeral.

#### 3.2 Validation

Ephemeral classification accuracy is assessed using the in situ ephemerality dataset (Section 1.4). We assess performance using regional classification accuracy, sensitivity (the true positive rate), specificity (the true negative rate), and "informedness", which is also called the true skill statistic (*TSS*) or Youden's *J* depending on the literature [@alloucheAssessingAccuracySpecies2006]. See Table S`r table_nums("classVal", display="n")` for metric definitions. *TSS* is equal to the sensitivity + specificity - 1. It intuitively represents the performance improvement over a random classifier, i.e. a score of zero indicates that the model is equivalent to random guessing. Mathematically, *TSS* equals the distance (in units of sensitivity) between a point on the receiver operating characteristic (ROC) curve and a random classifier. *TSS* is more robust to class imbalances than simple percent accuracy and it has been used in the past to assess headwater and ephemeral mapping models [@fesenmyerLargePortionUSA2021; @russellSpatiallyExplicitModel2015; @cavalloExploitingSentinel2Dataset2022]. We therefore use it here as well to compare against existing studies. Regional accuracy is mapped in Fig. S`r fig_nums_supp("mainVal", display="n")`, regional *TSS* is mapped in Fig. S`r fig_nums_supp("val2", display="n")`, regional sensitivity and specificity are mapped in Fig. S3, and boxplots of all metrics are Fig. S`r fig_nums_supp("val4", display="n")`. The validation results are discussed in Supplementary Materials S1.

#### 3.3 Choosing a validation snapping threshold
In general, classification performance should decrease as the snapping threshold increases because the in situ data will be assigned to the wrong rivers. So, we test the sensitivity of our model to this threshold to inform our choice of parameter value.

First, we re-project all data using the Universal Transverse Mercator (UTM) projection system to ensure snapping distances are regionally accurate. Then, we test a range of snapping thresholds from 5m to 50m and assess ephemeral classification accuracy (Fig. S`r fig_nums_supp("classificationSens", display="n")`). We also test which snapping thresholds reproduce expected network scaling patterns according to Horton's law of stream numbers [@hortonErosionalDevelopmentStreams1945]. Equation S4 is the Horton law of stream numbers, which is a power-law function relating stream order $SO_m$ to the number of streams in the $m^{th}$ order $N_m$ [@hortonErosionalDevelopmentStreams1945]. $R_B$ is the Horton ratio and $N_{max}$ is the number of streams in the largest order. $R_B$ is solved via least-squares regression.

$$N_m=N_{max}*R_B^{SO_{max} - SO_m} \mathbf{(S4)}$$

We fit equation S4 to our in situ ephemerality data after snapping to the NHD-HR using some threshold. We then assess how well the observed $N_{m}$ (section 1.4) matches the $N_{m}$ predicted by Horton's laws (equation S4). This approach assumes the following:

- Ephemeral streams aggregated from many CONUS drainage networks will fit a single Horton scaling. Horton laws are a statistical inevitability of stream ordering and do not represent an inherent geomorphic process [@kirchnerStatisticalInevitabilityHorton1993; @miltonGeomorphicIrrelevanceDrainage1966; @bowdenEffectStreamorderingTechnique1964], but rather arise from hydrography resolution and channelization definitions. Because we use a CONUS-scale product with consistent stream ordering, this is reasonable.

- The in situ ephemerality data (section 1.4) is representative of the actual distribution of ephemeral streams across CONUS. Because these data consist of voluntary field assessments, it is likely an underestimate of ephemeral stream presence. Actual estimates are presumably even greater.

Overall, we find that the ephemeral river network most closely matches expected network scaling with a snapping threshold of 5-15m (Fig. S`r fig_nums_supp("snappingSens", display="n")`). Otherwise, this scaling relationship begins to break down. Taking Figs. S`r fig_nums_supp("classificationSens", display="n")`-S`r fig_nums_supp("snappingSens", display="n")` in aggregate, we find a snapping threshold of 10m to be most appropriate for our purposes. This threshold also conveniently allows a direct comparison against the only existing ephemeral classification model [@fesenmyerLargePortionUSA2021], built using 10m gridded flow accumulation data.

#### 3.4 Influence of hydrography resolution
Given that much of the in situ ephemerality data does not fall on the mapped drainage network and instead corresponds to streams too small to be explicitly represented in the NHD-HR, we also assess 1) the amount of ephemeral streams we are missing, and 2) whether this matters for our goals of quantifying ephemeral contributions to CONUS discharge. To do this, equation S4 can be re-expressed as equation S5 to calculate the ephemeral stream orders not represented in the NHD-HR, where *k* is the minimum stream order. The in situ ephemerality data (section 1.4) provides us with $N_k$ enabling the direct calculation of $SO_k$. This approach assumes that all streams in the scaled stream order(s) are ephemeral. Given that `r perc_riverSource_eph`% of CONUS 'source reach' extent is ephemeral in our model, it is reasonable to assume that everything upstream of these is also ephemeral.

$$SO_k = \frac{log(N_k) - log(N_{max}) - SO_{max}log(R_B)}{-log(R_B)} \mathbf{(S5)}$$

Using equation S5, we find that one additional ephemeral stream order would need to be added to the NHD-HR to reproduce the field data distribution (Fig. S`r fig_nums_supp("scalingFig", display="n")`). The likely significant omission errors in the in situ ephemerality data suggest that one additional stream order is a conservative estimate. This has different implications for our various results. Because discharge generally accumulates downstream, we can assume that our model's headwater ephemeral discharge contributions (Fig. `r fig_nums("figQ_SO", display="n")`a) implicitly include the scaled ephemeral stream order as well, despite not being explicitly mapped in the NHD-HR. This may inflate the influence of first-order streams (Fig. `r fig_nums("figQ_SO", display="n")`a), but it does not influence the basin-wide results (Fig.  `r fig_nums("figQ", display="n")`). However, it does significantly affect our ephemeral network extent (Fig.  `r fig_nums("figLengthEph", display="n")`), which should be taken as a conservative estimate as we cannot verify how many ephemeral orders might lie above the NHD’s ‘first’ order streams.

### 4 Estimating ephemeral flow frequency
We estimate the basin-average flow frequency of ephemeral streams via the mean annual number of days per year that they flow ($N_{flw}$- equation S3). We do this using mean annual, basin-averaged runoff data measured at streamgauges [@brakebillDigitalHydrologicNetworks2011] and 27 years of daily interpolated precipitation data for 1980-2006 [@xieGaugeBasedAnalysisDaily2007; @chenAssessingObjectiveTechniques2008]. The model is purposefully simple but globally scalable (Fig. `r fig_nums("figNflw", display="n")`).

#### 4.1 Data
We use field data only to determine an operational runoff threshold, as well to verify the model's performance. Note that in situ $N_{flw}$ data is relatively uncommon and measured using different sensors (streamgauges, temporary flumes, and electrical resistance senors). To our knowledge, we use all existing field data [@zimmerBidirectionalStreamGroundwater2017; @fritzCoarseParticulateOrganic2019; @kampfRainfallThresholdsFlow2018; @slaughterThirtyfiveYearsResearch2001; @stoneLongtermRunoffDatabase2008; @schoenerImpactUrbanizationStormwater2022; @strombergRiparianVegetationEphemeral2017; @peirceCharacterizingEphemeralStreams2015] that provides sufficient information to calculate $N_{flw}$ (Table S`r table_nums("Nflw_data", display="n")` details the studies). We also supplement this data with the ephemeral USGS streamgauges previously described in section 1.2. To get all data in a uniform format, we calculate mean annual $N_{flw}$ at each sensor (if applicable), and then take the catchment average $N_{flw}$ across the sensed streams (again, if applicable). This averaging was not done in catchments with insufficient data and therefore significant uncertainties exist in many of these estimates. Despite these uncertainties, this limited data is to our knowledge the largest collection of in situ $N_{flw}$ measurements.

Length of the timeseries varies significantly, from approximately 1/3 of a year [@peirceCharacterizingEphemeralStreams2015] to 45 years of sub-daily data in the Walnut Gulch Experimental Watershed [@stoneLongtermRunoffDatabase2008]. Data from @peirceCharacterizingEphemeralStreams2015 exist for three sites within a catchment in Ontario that do not flow into the United States. However, they are located approximately 15 km from one of our model basins that does flow into the United States (Fig. `r fig_nums("figNflw", display="n")`a) and so we use that basin for verification. Additionally, that data is only for 1/3 of the year (approximately July to October). To obtain a mean annual estimate, we assumed the frequency of flow was the same year round, i.e. we tripled the $N_{flw}$ measured in their study. Likewise, @fritzCoarseParticulateOrganic2019 only assessed their streams for the latter half of a year, though reports indicate that flow generally occurs only 1-2 times in the remaining months [@fritzStructuralFunctionalCharacteristics2010], so we added that to the calculation. Finally, one site [@zimmerBidirectionalStreamGroundwater2017] includes an intermittent main stem where the flow was measured, however the rest of the drainage system is ephemeral [@zimmerBidirectionalStreamGroundwater2017].

#### 4.2 Model
Streams are traditionally viewed as a surficial expression of groundwater [@winterGroundWaterSurface1998]. However, by definition ephemeral streams extend beyond the boundary of the surface extent of groundwater [@zimmerLateralVerticalLongitudinal2018]. Because they have no groundwater component, $N_{flw}$ is purely controlled by surface runoff and interflow. This assumption significantly simplifies our modeling and enables the estimation of $N_{flw}$ solely via surface runoff generation.

In that context, we first calculate a mean annual basin runoff ratio $i_r$ to convert precipitation *P* to stream runoff *i* and vice versa. The runoff ratio (equation S6) reflects the proportion of rainfall on the basin that winds up as stream runoff, where the implicit losses are via groundwater recharge and evapotranspiration. Using a mean annual $i_r$ also implicitly accounts for snowmelt runoff in winter.

$$i_r = \frac{i}{P} \mathbf{(S6)}$$

We convert daily precipitation depth to daily, basin-averaged stream runoff depth using $i_r$. Per equation S3, streamflow occurs when daily runoff exceeds some operational runoff threshold. We tally all days when flow occurs over the 27 years and calculate a mean annual $N_{flw}$, which is mapped in Fig. `r fig_nums("figNflw", display="n")`a. For a handful of basins on the Mexican/Canadian borders, there are no USGS gauges and no $i_r$ data. We use the mean annual runoff values from adjacent basins (the "closest" as assessed visually) and assume it holds constant in these basins. We perform a sensitivity test of the $i_r$ data, as it is biased towards gauged, often larger, rivers. For this test, we use equation S3 and run the model under four scenarios: inflating and deflating the runoff ratio by 18% and 33%. Across CONUS, results change minimally (Fig. S`r fig_nums_supp("nFlwSens", display="n")`).

We also parameterize watershed 'memory': a bulk parameter representing all delayed runoff to the drainage network. More practically, the memory parameter keeps streams 'turned on' for a number of days following a day identified as flowing. Memory parameter assignment was guided by a recent analysis [@mogesStrengthMemoryPrecipitation2022], which calculated the streamflow memory of rain events for 671 watersheds in CONUS (including many with groundwater influence). They found a median memory of approximately four days, which is used here.

The operational $i_{min}$ is determined using the $N_{flw}$ field data (section 4.1) as (to our knowledge) there is no consensus on what runoff depth defines a flowing stream and even then there are known limitations to measuring low flows in the field [@seyboldHowLowCan2023]. Further, the coarse spatial resolution of our precipitation data can't reconcile sub-pixel heterogeneity and thus limits our ability to remotely sense the smallest runoff events (potentially inflating the smallest rain events at the sub-pixel scale). So, we calibrate $i_{min}$ in lieu of other available data, acknowledging that this operational definition of $i_{min}$ may change with additional field measurements of $N_{flw}$. We use the coefficient of determination $r^2$, the mean absolute error (*MAE*) and the root mean square error (*RMSE*) to determine the best performing $i_{min}$ of approximately 2.5 mm/day (Fig. `r fig_nums("figNflw", display="n")`b-c, Fig. S`r fig_nums_supp("runoffCalib", display="n")`). We express uncertainty in the average estimate as 1 standard error (SE) of the regression between predicted and observed. We stress that because of the limited and highly uncertain data on $N_{flw}$ and the necessary calibration of $i_{min}$, we refer to this as a model verification: all we can do is confirm that the model is reasonably realistic.

## Supplementary Materials S1
### Discharge model performance
The discharge model accurately captures mean annual discharges for 1970-2018 across both perennial and non-perennial streams (Fig. S`r fig_nums_supp("mainVal", display="n")`). This performance is similar to another discharge model used to map global river intermittency [@messagerGlobalPrevalenceNonperennial2021].

### Groundwater model performance
The log-residuals of the groundwater model validation (Fig. S`r fig_nums_supp("grdwrtrVal", display="n")`) show reasonable performance for a global model. The resulting errors are similar to the previous global validation of this model [@fanGlobalPatternsGroundwater2013; @fanHydrologicRegulationPlant2017] and other similar models [@condonGlobalGroundwaterModeling2021; @degraafHighresolutionGlobalscaleGroundwater2015]. The small bias underestimating the water table depth (mean residual of -0.236 meters) is likely due to not simulating groundwater pumping. This leads to an underestimation of ephemeral streams which is discussed in the Main Text.

### Ephemeral classification performance
Ephemeral mapping performance varies across the United States. Regional average *TSS* is `r round(mean(val_shapefile_fin$basinTSS, na.rm=T),2)` (Fig. S`r fig_nums_supp("val2", display="n")`a), average regional accuracy is `r ceiling(mean(val_shapefile_fin$basinAccuracy)*100)`% (Fig. S`r fig_nums_supp("mainVal", display="n")`a), average regional sensitivity is `r ceiling(mean(val_shapefile_fin$basinSensitivity, na.rm=T)*100)`% (Fig. S`r fig_nums_supp("val3", display="n")`a) and average regional specificity was `r round(mean(val_shapefile_fin$basinSpecificity*100),0)`% (Fig. S`r fig_nums_supp("val3", display="n")`b). Performance is best in northeastern CONUS and western CONUS (average *TSS* of `r round(mean(val_shapefile_fin[val_shapefile_fin$huc2 %in% goodAccuracy,]$basinTSS),2)`), while performance is worse in the Ohio and Lower Mississippi river basins (average *TSS* of `r round(mean(val_shapefile_fin[val_shapefile_fin$huc2 %in% badAccuracy,]$basinTSS),2)`). Overall, we outperform the only two existing CONUS ephemeral stream maps. @fesenmyerLargePortionUSA2021 reported a CONUS *TSS* of 0.45, sensitivity of 63%, and specificity of 83% and @greenhillMachineLearningPredicts2024, who mapped ephemeral streams using deep learning models for over 4 million random locations around CONUS, reported an ephemeral classification accuracy of 75%.

### Overall performance in an ephemeral catchment
The Walnut Gulch experimental watershed in Arizona is home to one of the longest continuous ephemeral streamgauge records in the world and features an in situ flume network that enables whole-watershed studies for arid hydrology [@stoneLongtermRunoffDatabase2008]. The entire watershed drainage network is ephemeral. Here, we verify that our model 1) reproduces the completely-ephemeral drainage system (Fig. S`r fig_nums_supp("walnutGulch", display="n")`a) and 2) reproduces the mean annual ephemeral discharges throughout the drainage network (Fig. S`r fig_nums_supp("walnutGulch", display="n")`b).

### Equations S1 and S2 performance
At continental scales, it is impossible to validate equations S1 and S2 in a traditional sense. To broadly verify that our calculations make sense, we use Tokunaga ratios to compare our modeled metric to an independent, back-of-the-envelope metric obtained from Tokunaga scaling (Fig. S`r fig_nums_supp("mainVal", display="n")`c). This approach we extends previous work [@alexanderRoleHeadwaterStreams2007] that used Tokunaga network scaling in the northeastern US to verify relative headwater contributions to downstream discharge. Tokunaga ratios represent the average number of upstream reaches that flow into the average reach per stream order [@zanardoAreAmericanRivers2013; @alexanderRoleHeadwaterStreams2007]. Assuming that discharge accumulates downstream, relative ephemeral Tokunaga ratios should be approximately similar to our routing calculations, i.e. if 50% of upstream rivers are ephemeral, than 50% of discharge would be ephemerally sourced in a perfectly gaining watershed.

To do this, we calculate the average cumulative length of upstream ephemeral rivers per stream order. We use network length rather than number of reaches to handle the artificial paths necessary to incorporate lakes and reservoirs into the drainage network [@brinkerhoffLakeMorphometryRiver2021]. For the largest stream order, we then divide this value by the total network length to obtain a relative upstream contribution to the watershed mouth. When compared against our moddel (Fig. S`r fig_nums_supp("mainVal", display="n")`c), we confirm our results are in line with those obtained independnetly by network scaling theory. This provides additional confirmation that our model produces reasonable metrics.

### Potential uncertainties
Potential model uncertainties center on the bankfull depth model and the water table model.

For the water table model [@fanGlobalPatternsGroundwater2013; @fanHydrologicRegulationPlant2017], uncertainties come from (1) general model performance and (2) the model’s spatial resolution (~1km). For the former, we validate the mean monthly water table depths at over 5,000 sites (over 60,000 total validation points for 12 months) across CONUS and define a log-error distribution (mean: `r validated_wells$mean`m, sd: `r validated_wells$sd`m), see Fig. S`r fig_nums_supp("grdwrtrVal", display="n")`. For the latter, our two primary concerns are resolution misalignment between the hydrography and the groundwater model and/or spatial misalignment, i.e. errors in river location in steep terrain might map streams into the ‘next pixel over’.

For resolution misalignment, we use the Cedar Brook Catchment in New Hampshire’s White Mountains (Fig. S`r fig_nums_supp("merrimack_reach_example", display="n")`) as an illustrative example to show the groundwater model resolution (~1km) compared to the NHD-HR hydrography resolution (average reach length across all CONUS basins of `r round(mean(combined_meanLengthKM, na.rm=T),1)` km). The approximately equal resolutions suggest that it is not a significant source of error. Also note that resolution uncertainty is already implicit in our groundwater validation: we validated point-based well depths against a ~1km gridded model (Fig. S`r fig_nums_supp("grdwrtrVal", display="n")`). This will capture any resolution-induced errors between wells and the model.

Spatial misalignment is reasonably handled by our summarizing along the reaches: when there are multiple pixels along a reach, we take the median water table value to capture a representative, reach-scale picture of water table depths (Fig. S`r fig_nums_supp("merrimack_reach_example", display="n")`) that are robust to misalignment. Finally, recall that after the initial classification comparing ‘depth to channel bottom’ to ‘depth to water table’, we use network routing to fix any artifacts that might arise from errors in the water table model. These steps in the algorithm significantly reduce the influence of potential resolution errors.

For the bankfull depth model, uncertainties come from (1) statistical performance of the power-law scaling and (2) the specific field measurement dataset used to fit the scaling relationship. (1) is an error of how well a power law represents bankfull depth, which is influenced by the fact that studies establishing this power law come from well-behaved alluvial systems that aren’t necessarily representative of all streams (particularly steep headwaters). (2) provides the degrees of freedom, scale, and heterogeneity to assess (1). To quantify this, we use the log-residuals of (1) to characterize error distributions per physiographic region (mean range: `r round(min(validated_Hb$mean_residual), 0)`-`r round(max(validated_Hb$mean_residual), 0)`m, sd range: `r round(min(validated_Hb$sd_residual),3)`-`r round(max(validated_Hb$sd_residual),3)`m) using the most extensive dataset to our knowledge of in situ bankfull depth measurements [@biegerDevelopmentEvaluationBankfull2015]. This dataset includes field-measured bankfull depth in a range of rivers, from large (100+m wide) well-behaved channels to smaller ones less than a meter wide. While there are still uncertainties baked into this approach, we feel it is the most robust we can produce given the currently available data.

### Quantification of uncertainty
We use Monte Carlo simulations to quantify the uncertainty in our main results (Figs. 1, Eq S1). Specifically, we push the two uncertainties defined above for water table depth (Fig. S`r fig_nums_supp("grdwrtrVal", display="n")`) and bankfull depth [@biegerDevelopmentEvaluationBankfull2015] through the entire modeling pipeline to build distributions of model results (Fig. S`r fig_nums_supp("grdwrtrVal", display="n")`). It is computationally infeasible to do this for the entire CONUS domain, so we focus on five smaller drainage basins that cover the major physiographic regions of the United States. For each reach, we randomly sample both error terms, add them to the modeled values, and run the pipeline. We did this 1,000 times in each basin.

In these five test basins, we find that our model results vary very little and that the standard deviation of these uncertainty distributions is < 1% (Fig. S`r fig_nums_supp("mcUncertainty", display="n")`). This suggests that uncertainties in the bankfull depth and the water table depth only marginally affect the final results. In the Suwannee basin in Florida/Georgia, where much of the water table is very shallow, uncertainties are slightly greater but still well within acceptable values (Fig. S`r fig_nums_supp("mcUncertainty", display="n")`).

## Supplementary Figures
![**Figure S`r fig_nums_supp("flowchart_classification", display="n")`:** `r substr(fig_nums_supp("flowchart_classification", display="full"), 11, nchar(fig_nums_supp("flowchart_classification", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/flowchart_classification.png)


\newpage

![**Figure S`r fig_nums_supp("valFlowchart", display="n")`:** `r substr(fig_nums_supp("valFlowchart", display="full"), 12, nchar(fig_nums_supp("valFlowchart", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/flowchart_validation.png)

\newpage

![**Figure S`r fig_nums_supp("flowchart_temporal", display="n")`:** `r substr(fig_nums_supp("flowchart_temporal", display="full"), 11, nchar(fig_nums_supp("flowchart_temporal", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/flowchart_temporal.png)

\newpage

![**Figure S`r fig_nums_supp("mainVal", display="n")`:** `r substr(fig_nums_supp("mainVal", display="full"), 11, nchar(fig_nums_supp("mainVal", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/validationPlot.jpg)

\newpage

![**Figure S`r fig_nums_supp("val2", display="n")`:** `r substr(fig_nums_supp("val2", display="full"), 11, nchar(fig_nums_supp("val2", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/validationMap.jpg)

\newpage

![**Figure S`r fig_nums_supp("val3", display="n")`:** `r substr(fig_nums_supp("val3", display="full"), 11, nchar(fig_nums_supp("val3", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/validationMap2.jpg)

\newpage

![**Figure S`r fig_nums_supp("val4", display="n")`:** `r substr(fig_nums_supp("val4", display="full"), 11, nchar(fig_nums_supp("val4", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/boxPlots_classification.jpg)

\newpage

![**Figure S`r fig_nums_supp("grdwrtrVal", display="n")`:** `r substr(fig_nums_supp("grdwrtrVal", display="full"), 11, nchar(fig_nums_supp("grdwrtrVal", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/gw_validation.jpg)

\newpage

![**Figure S`r fig_nums_supp("walnutGulch", display="n")`:** `r substr(fig_nums_supp("walnutGulch", display="full"), 11, nchar(fig_nums_supp("walnutGulch", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/walnutGulch.jpg)

\newpage

![**Figure S`r fig_nums_supp("classificationSens", display="n")`:** `r substr(fig_nums_supp("classificationSens", display="full"), 11, nchar(fig_nums_supp("classificationSens", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/acc_sens_to_snapping.jpg)

\newpage

![**Figure S`r fig_nums_supp("snappingSens", display="n")`:** `r substr(fig_nums_supp("snappingSens", display="full"), 11, nchar(fig_nums_supp("snappingSens", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/snappingThreshTradeOff.jpg)

\newpage

![**Figure S`r fig_nums_supp("scalingFig", display="n")`:** `r substr(fig_nums_supp("scalingFig", display="full"), 11, nchar(fig_nums_supp("scalingFig", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/scalingModel.jpg)

\newpage

![**Figure S`r fig_nums_supp("nFlwSens", display="n")`:** `r substr(fig_nums_supp("nFlwSens", display="full"), 11, nchar(fig_nums_supp("nFlwSens", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/boxPlots_sensitivity.jpg)

\newpage

![**Figure S`r fig_nums_supp("mcUncertainty", display="n")`:** `r substr(fig_nums_supp("mcUncertainty", display="full"), 11, nchar(fig_nums_supp("mcUncertainty", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/mcUncertaintyPlot.jpg)

\newpage

![**Figure S`r fig_nums_supp("merrimack_reach_example", display="n")`:** `r substr(fig_nums_supp("merrimack_reach_example", display="full"), 12, nchar(fig_nums_supp("merrimack_reach_example", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/merrimack_reach_example.png)

\newpage

![**Figure S`r fig_nums_supp("hydrographies1", display="n")`:** `r substr(fig_nums_supp("hydrographies1", display="full"), 12, nchar(fig_nums_supp("hydrographies1", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/hydrographyMaps_1.jpg)

\newpage

![**Figure S`r fig_nums_supp("hydrographies2", display="n")`:** `r substr(fig_nums_supp("hydrographies2", display="full"), 12, nchar(fig_nums_supp("hydrographies2", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/hydrographyMaps_2.jpg)

\newpage

![**Figure S`r fig_nums_supp("hydrographies3", display="n")`:** `r substr(fig_nums_supp("hydrographies3", display="full"), 12, nchar(fig_nums_supp("hydrographies3", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/hydrographyMaps_3.jpg)

\newpage

![**Figure S`r fig_nums_supp("hydrographies4", display="n")`:** `r substr(fig_nums_supp("hydrographies4", display="full"), 12, nchar(fig_nums_supp("hydrographies4", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/hydrographyMaps_4.jpg)

\newpage

![**Figure S`r fig_nums_supp("hydrographies5", display="n")`:** `r substr(fig_nums_supp("hydrographies5", display="full"), 12, nchar(fig_nums_supp("hydrographies5", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/hydrographyMaps_5.jpg)

\newpage

![**Figure S`r fig_nums_supp("hydrographies6", display="n")`:** `r substr(fig_nums_supp("hydrographies6", display="full"), 12, nchar(fig_nums_supp("hydrographies6", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/hydrographyMaps_6.jpg)

\newpage

![**Figure S`r fig_nums_supp("hydrographies7", display="n")`:** `r substr(fig_nums_supp("hydrographies7", display="full"), 12, nchar(fig_nums_supp("hydrographies7", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/hydrographyMaps_7.jpg)

\newpage

![**Figure S`r fig_nums_supp("hydrographies8", display="n")`:** `r substr(fig_nums_supp("hydrographies8", display="full"), 12, nchar(fig_nums_supp("hydrographies8", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/hydrographyMaps_8.jpg)

\newpage

![**Figure S`r fig_nums_supp("hydrographies9", display="n")`:** `r substr(fig_nums_supp("hydrographies9", display="full"), 12, nchar(fig_nums_supp("hydrographies9", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/hydrographyMaps_9.jpg)

\newpage

![**Figure S`r fig_nums_supp("hydrographies10", display="n")`:** `r substr(fig_nums_supp("hydrographies10", display="full"), 12, nchar(fig_nums_supp("hydrographies10", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/hydrographyMaps_10.jpg)

\newpage

![**Figure S`r fig_nums_supp("hydrographies11", display="n")`:** `r substr(fig_nums_supp("hydrographies11", display="full"), 12, nchar(fig_nums_supp("hydrographies11", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/hydrographyMaps_11.jpg)

\newpage

![**Figure S`r fig_nums_supp("hydrographies12", display="n")`:** `r substr(fig_nums_supp("hydrographies12", display="full"), 12, nchar(fig_nums_supp("hydrographies12", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/hydrographyMaps_12.jpg)

\newpage

![**Figure S`r fig_nums_supp("hydrographies13", display="n")`:** `r substr(fig_nums_supp("hydrographies13", display="full"), 12, nchar(fig_nums_supp("hydrographies13", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/hydrographyMaps_13.jpg)

\newpage

![**Figure S`r fig_nums_supp("drainageAreaMap", display="n")`:** `r substr(fig_nums_supp("drainageAreaMap", display="full"), 12, nchar(fig_nums_supp("drainageAreaMap", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/drainageAreaMap.jpg)

\newpage

![**Figure S`r fig_nums_supp("figQ_physio", display="n")`:** `r substr(fig_nums_supp("figQ_physio", display="full"), 12, nchar(fig_nums_supp("figQ_physio", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/by_order_and_physio_region.jpg)

\newpage

![**Figure S`r fig_nums_supp("runoffCalib", display="n")`:** `r substr(fig_nums_supp("runoffCalib", display="full"), 12, nchar(fig_nums_supp("runoffCalib", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/runoffThresh_fitting.jpg)

\newpage

![**Figure S`r fig_nums_supp("meanFlowDate", display="n")`:** `r substr(fig_nums_supp("meanFlowDate", display="full"), 12, nchar(fig_nums_supp("meanFlowDate", display="full")))`](/nas/cee-water/cjgleason/craig/CONUS_ephemeral/cache/meanFlowDate.jpg)

\newpage

## Supplementary Tables

**Table S`r table_nums("data_summary", display="n")`:** `r substr(table_nums("data_summary", display="full"), 11, nchar(table_nums("data_summary", display="full")))`

|Variable           | Dataset Name                                              | Spatial Resolution        | Temporal Resolution | Years captured          | Reference                                                               |
|-------------------|-----------------------------------------------------------|---------------------------|---------------------|-------------------------|-------------------------------------------------------------------------|
| Hydrography       | USGS National Hydrography Dataset High Resolution (NHD-HR)| 1:24,000                  | -                   | Long-term               | [@u.s.geologicalsurveyNationalHydrographyDataset2022]                   |
| Discharge         | USGS Mean Annual Discharge Model                          | 1:24,000                  | Year                | 1970-2000               | [@u.s.geologicalsurveyNationalHydrographyDataset2022]                   |
| Water Table Depth | Fan Global Soil Hydrology Model                           | 30"                       | Month               | 2004-2014               | [@fanHydrologicRegulationPlant2017; @fanGlobalPatternsGroundwater2013]  |
| Precipitation     | CPC Unified Gauge-Based Daily Precipitation Model         | 0.25'                     | Day                 | 1980-2006               | [@xieGaugeBasedAnalysisDaily2007; @chenAssessingObjectiveTechniques2008]|
| Runoff            | USGS Runoff Data                                          | USGS level 4 basins       | Year                | varies (from 1901-2021) | [@brakebillDigitalHydrologicNetworks2011]                               |

\newpage

**Table S`r table_nums("Nflw_data", display="n")`:** `r substr(table_nums("Nflw_data", display="full"), 11, nchar(table_nums("Nflw_data", display="full")))`

```{r, echo=FALSE}
df <- flowingDaysValidation
df$num_flowing_dys <- round(df$num_flowing_dys, 0)
df$n_flw_d <- round(df$n_flw_d, 0)
df$drainage_area_km2 <- round(df$drainage_area_km2, 0)
df <- df[,c(2,5,6,7,8,9)]
knitr::kable(df, format = "pipe", col.names = c('Drainage Basin', 'Observed Nflw [dys]', 'Number Sample Years', 'Drainage Area [km2]', 'Number Sites','Reference'), row.names = FALSE)
```

\newpage

**Table S`r table_nums("classVal", display="n")`:** `r substr(table_nums("classVal", display="full"), 11, nchar(table_nums("classVal", display="full")))`

| Name                   | Definition                                          |
|------------------------|-----------------------------------------------------|
| Accuracy               | $\frac{N_{TP}+N_{TN}}{N_{TP}+N_{TN}+N_{FP}+N_{FN}}$ |
| Sensitivity            | $\frac{N_{TP}}{N_{TP}+N_{FN}}$                      |
| Specificity            | $\frac{N_{TN}}{N_{TN}+N_{FP}}$                      |
| True Skill Score (TSS) | Sensitivity + Specificity - 1                       |

\newpage

**Table S`r table_nums("field_data", display="n")`:** `r substr(table_nums("field_data", display="full"), 11, nchar(table_nums("field_data", display="full")))`

```{r, echo=FALSE, message=FALSE}
df <- readr::read_csv('/nas/cee-water/cjgleason/craig/CONUS_ephemeral_data/for_ephemeral_project/new_england_fieldSites.csv')
df <- dplyr::select(df, c('name', 'lat', 'lon', 'score', 'classification'))

knitr::kable(df[, 1:5], format = "pipe", col.names = c('Name', 'Latitude', 'Longitude', 'Score', 'Classification'))

```

\newpage

## References
